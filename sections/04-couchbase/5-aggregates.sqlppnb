{"cells":[{"kind":2,"language":"SQL++","value":"select person.name, AVG(rating) as avg_rating\r\nfrom [\r\n\t{ \"name\": \"John\", \"rating\": 3.5 },\r\n\t{ \"name\": \"John\", \"rating\": 5   },\r\n\t{ \"name\": \"John\", \"rating\": 4.5 },\r\n\t{ \"name\": \"Mary\", \"rating\": 5   },\r\n\t{ \"name\": \"Jack\", \"rating\": 4.8 },\r\n\t{ \"name\": \"Jack\", \"rating\": 4.4 },\r\n\t{ \"name\": \"Jack\", \"rating\": 4.9 }\r\n] person\r\nGROUP BY person.name\r\norder by person.name"},{"kind":2,"language":"SQL++","value":"select name, id, bill,\r\n    bill + IFNULL(LAG(bill, 1) OVER win, 0) as crt_balance,\r\n    LAST_VALUE(bill) OVER win as last_entry,\r\n    ROW_NUMBER() OVER win as entry_id\r\nfrom [\r\n    { \"name\": 'John', \"bill\": 100, \"id\": 3 },\r\n    { \"name\": 'John', \"bill\": 200, \"id\": 1 },\r\n    { \"name\": 'Mary', \"bill\": 180, \"id\": 2 }\r\n] p\r\nWINDOW win AS (PARTITION BY name ORDER BY id)\r\norder by name, id"},{"kind":2,"language":"SQL++","value":"select person.name, rating\r\nfrom [\r\n    { \"name\": 'John', \"ratings\": [3.5, 5.0, 4.5] },\r\n    { \"name\": 'Mary', \"ratings\": [5.0] },\r\n    { \"name\": 'Jack', \"ratings\": [4.8, 4.4, 4.9] }\r\n] person\r\nUNNEST person.ratings as rating"},{"kind":2,"language":"SQL++","value":"select person.name,\r\n    ARRAY_AVG(person.ratings) as avg_ratings\r\nfrom [\r\n    { \"name\": 'John', \"ratings\": [3.5, 5.0, 4.5] },\r\n    { \"name\": 'Mary', \"ratings\": [5.0] },\r\n    { \"name\": 'Jack', \"ratings\": [4.8, 4.4, 4.9] }\r\n] person\r\nGROUP BY person.name, person.ratings"},{"kind":2,"language":"SQL++","value":"with customers as (\r\n    select c.* from [\r\n        { \"id\": 1, \"name\": 'John', \"balance\": 22.34 },\r\n        { \"id\": 2, \"name\": 'Mary', \"balance\": 120 },\r\n        { \"id\": 3, \"name\": 'Jack', \"balance\": 145 }] c),\r\n\r\nemployees as (\r\n    select e.* from [\r\n        { \"employee\": 'Steven', \"age\": 22 },\r\n        { \"employee\": 'Mary', \"age\": 18 }] e)\r\n\r\nselect raw c.name as name from customers c\r\nINTERSECT\r\nselect raw e.employee as name from employees e"}]}